package com.nhsoft.report.model;



import com.nhsoft.report.dto.SettlementTypeDTO;
import com.nhsoft.report.shared.State;
import org.apache.commons.lang3.StringUtils;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * WholesaleOrder generated by hbm2java
 */
public class WholesaleOrder implements java.io.Serializable {

	private static final long serialVersionUID = -3724174597778782107L;
	private String wholesaleOrderFid;
	private String systemBookCode;
	private Integer branchNum;
	private Integer storehouseNum;
	private String wholesaleBookFid;
	private String clientFid;
	private Date wholesaleOrderDate;
	private Date wholesaleOrderPaymentDate;
	private String wholesaleOrderSeller;
	private State state;
	private Date wholesaleOrderCreateTime;
	private String wholesaleOrderCreator;
	private Date wholesaleOrderAuditTime;
	private String wholesaleOrderAuditor;
	private String wholesaleOrderMemo;
	private BigDecimal wholesaleOrderCommission;
	private BigDecimal wholesaleOrderTotalMoney;
	private BigDecimal wholesaleOrderDiscountMoney;
	private BigDecimal wholesaleOrderDueMoney;
	private BigDecimal wholesaleOrderPaidMoney;
	private Date wholesaleOrderLastestPaymentDate;
	private String wholesaleOrderUuid;
	private Boolean wholesaleOrderTransferFlag;
	private Date wholesaleOrderSendTime;
	private Date wholesaleOrderPickingTime;
	private String wholesaleOrderPayType;
	private BigDecimal wholesaleOrderPayMoney;
	private Integer accountBankNum;
	private BigDecimal wholesaleOrderPayDiscount;
	private Integer wholesaleOrderPrintCount;
	private Integer regionNum;
	private String wholesaleOrderInnerNo;
	private Boolean wholesaleOrderRepealFlag;
	private String wholesaleOrderBillNo;
	private String wholesaleOrderPicker;
	private Boolean wholesaleOrderAntiFlag;
	private BigDecimal wholesaleOrderCostMoney;
	private String wholesaleOrderSender;
	private String wholesaleOrderAuditBizday;
	private String wholesaleOrderSettlementType;
	private List<WholesaleOrderDetail> wholesaleOrderDetails = new ArrayList<WholesaleOrderDetail>(0);

	
	//按顶级类拆单时用
	private String topCategory;
	private List<SettlementTypeDTO> settlementTypeDTOs = null;
	
	private AppUser appUser;
	private Boolean keepInnerNo = false;//保存时是否保留手工单号
	private Boolean tempAudit;

	private String copyFid;


	public Boolean getTempAudit() {
		return tempAudit;
	}

	public void setTempAudit(Boolean tempAudit) {
		this.tempAudit = tempAudit;
	}

	public List<SettlementTypeDTO> getSettlementTypeDTOs() {
		return settlementTypeDTOs;
	}

	public void setSettlementTypeDTOs(List<SettlementTypeDTO> settlementTypeDTOs) {
		this.settlementTypeDTOs = settlementTypeDTOs;
	}

	public String getCopyFid() {
		return copyFid;
	}

	public void setCopyFid(String copyFid) {
		this.copyFid = copyFid;
	}
	

	
    public WholesaleOrder() {
	}

    public Boolean getKeepInnerNo() {
		return keepInnerNo;
	}

	public void setKeepInnerNo(Boolean keepInnerNo) {
		this.keepInnerNo = keepInnerNo;
	}

	public String getWholesaleOrderSettlementType() {
		return wholesaleOrderSettlementType;
	}

	public void setWholesaleOrderSettlementType(String wholesaleOrderSettlementType) {
		this.wholesaleOrderSettlementType = wholesaleOrderSettlementType;
	}

	public String getWholesaleOrderAuditBizday() {
		return wholesaleOrderAuditBizday;
	}

	public void setWholesaleOrderAuditBizday(String wholesaleOrderAuditBizday) {
		this.wholesaleOrderAuditBizday = wholesaleOrderAuditBizday;
	}

	public String getWholesaleOrderSender() {
		return wholesaleOrderSender;
	}

	public void setWholesaleOrderSender(String wholesaleOrderSender) {
		this.wholesaleOrderSender = wholesaleOrderSender;
	}

	public BigDecimal getWholesaleOrderCostMoney() {
		return wholesaleOrderCostMoney;
	}

	public void setWholesaleOrderCostMoney(BigDecimal wholesaleOrderCostMoney) {
		this.wholesaleOrderCostMoney = wholesaleOrderCostMoney;
	}

	public Boolean getWholesaleOrderAntiFlag() {
		return wholesaleOrderAntiFlag;
	}

	public void setWholesaleOrderAntiFlag(Boolean wholesaleOrderAntiFlag) {
		this.wholesaleOrderAntiFlag = wholesaleOrderAntiFlag;
	}

	public String getWholesaleOrderPicker() {
		return wholesaleOrderPicker;
	}

	public void setWholesaleOrderPicker(String wholesaleOrderPicker) {
		this.wholesaleOrderPicker = wholesaleOrderPicker;
	}

	public AppUser getAppUser() {
		return appUser;
	}

	public void setAppUser(AppUser appUser) {
		this.appUser = appUser;
	}

	public Boolean getWholesaleOrderRepealFlag() {
		return wholesaleOrderRepealFlag;
	}

	public void setWholesaleOrderRepealFlag(Boolean wholesaleOrderRepealFlag) {
		this.wholesaleOrderRepealFlag = wholesaleOrderRepealFlag;
	}

	public String getWholesaleOrderBillNo() {
		return wholesaleOrderBillNo;
	}

	public void setWholesaleOrderBillNo(String wholesaleOrderBillNo) {
		this.wholesaleOrderBillNo = wholesaleOrderBillNo;
	}

	public Integer getWholesaleOrderPrintCount() {
		return wholesaleOrderPrintCount;
	}

	public void setWholesaleOrderPrintCount(Integer wholesaleOrderPrintCount) {
		this.wholesaleOrderPrintCount = wholesaleOrderPrintCount;
	}

	public Date getWholesaleOrderSendTime() {
		return wholesaleOrderSendTime;
	}

	public void setWholesaleOrderSendTime(Date wholesaleOrderSendTime) {
		this.wholesaleOrderSendTime = wholesaleOrderSendTime;
	}

	public Date getWholesaleOrderPickingTime() {
		return wholesaleOrderPickingTime;
	}

	public void setWholesaleOrderPickingTime(Date wholesaleOrderPickingTime) {
		this.wholesaleOrderPickingTime = wholesaleOrderPickingTime;
	}

	public String getWholesaleOrderFid() {
		return this.wholesaleOrderFid;
	}

	public void setWholesaleOrderFid(String wholesaleOrderFid) {
		this.wholesaleOrderFid = wholesaleOrderFid;
	}

	public String getSystemBookCode() {
		return this.systemBookCode;
	}

	public void setSystemBookCode(String systemBookCode) {
		this.systemBookCode = systemBookCode;
	}

	public Integer getBranchNum() {
		return this.branchNum;
	}

	public void setBranchNum(Integer branchNum) {
		this.branchNum = branchNum;
	}

	public String getClientFid() {
		return this.clientFid;
	}

	public void setClientFid(String clientFid) {
		this.clientFid = clientFid;
	}

	public String getWholesaleBookFid() {
		return this.wholesaleBookFid;
	}

	public void setWholesaleBookFid(String wholesaleBookFid) {
		this.wholesaleBookFid = wholesaleBookFid;
	}

	public Integer getStorehouseNum() {
		return this.storehouseNum;
	}

	public void setStorehouseNum(Integer storehouseNum) {
		this.storehouseNum = storehouseNum;
	}

	public Date getWholesaleOrderDate() {
		return this.wholesaleOrderDate;
	}

	public void setWholesaleOrderDate(Date wholesaleOrderDate) {
		this.wholesaleOrderDate = wholesaleOrderDate;
	}

	public Date getWholesaleOrderPaymentDate() {
		return this.wholesaleOrderPaymentDate;
	}

	public void setWholesaleOrderPaymentDate(Date wholesaleOrderPaymentDate) {
		this.wholesaleOrderPaymentDate = wholesaleOrderPaymentDate;
	}

	public String getWholesaleOrderSeller() {
		return this.wholesaleOrderSeller;
	}

	public void setWholesaleOrderSeller(String wholesaleOrderSeller) {
		this.wholesaleOrderSeller = wholesaleOrderSeller;
	}

	public State getState() {
		return state;
	}

	public void setState(State state) {
		this.state = state;
	}

	public Date getWholesaleOrderCreateTime() {
		return this.wholesaleOrderCreateTime;
	}

	public void setWholesaleOrderCreateTime(Date wholesaleOrderCreateTime) {
		this.wholesaleOrderCreateTime = wholesaleOrderCreateTime;
	}

	public String getWholesaleOrderCreator() {
		return this.wholesaleOrderCreator;
	}

	public void setWholesaleOrderCreator(String wholesaleOrderCreator) {
		this.wholesaleOrderCreator = wholesaleOrderCreator;
	}

	public Date getWholesaleOrderAuditTime() {
		return this.wholesaleOrderAuditTime;
	}

	public void setWholesaleOrderAuditTime(Date wholesaleOrderAuditTime) {
		this.wholesaleOrderAuditTime = wholesaleOrderAuditTime;

	}

	public String getWholesaleOrderAuditor() {
		return this.wholesaleOrderAuditor;
	}

	public void setWholesaleOrderAuditor(String wholesaleOrderAuditor) {
		this.wholesaleOrderAuditor = wholesaleOrderAuditor;
	}

	public String getWholesaleOrderMemo() {
		return this.wholesaleOrderMemo;
	}

	public void setWholesaleOrderMemo(String wholesaleOrderMemo) {
		this.wholesaleOrderMemo = wholesaleOrderMemo;
	}

	public BigDecimal getWholesaleOrderCommission() {
		return this.wholesaleOrderCommission;
	}

	public void setWholesaleOrderCommission(BigDecimal wholesaleOrderCommission) {
		this.wholesaleOrderCommission = wholesaleOrderCommission;
	}

	public BigDecimal getWholesaleOrderTotalMoney() {
		return this.wholesaleOrderTotalMoney;
	}

	public void setWholesaleOrderTotalMoney(BigDecimal wholesaleOrderTotalMoney) {
		this.wholesaleOrderTotalMoney = wholesaleOrderTotalMoney;
	}

	public BigDecimal getWholesaleOrderDiscountMoney() {
		return this.wholesaleOrderDiscountMoney;
	}

	public void setWholesaleOrderDiscountMoney(
			BigDecimal wholesaleOrderDiscountMoney) {
		if(wholesaleOrderDiscountMoney != null){
			wholesaleOrderDiscountMoney = wholesaleOrderDiscountMoney.setScale(2, BigDecimal.ROUND_HALF_UP);
		}
		this.wholesaleOrderDiscountMoney = wholesaleOrderDiscountMoney;
	}

	public BigDecimal getWholesaleOrderDueMoney() {
		return this.wholesaleOrderDueMoney;
	}

	public void setWholesaleOrderDueMoney(BigDecimal wholesaleOrderDueMoney) {
		if(wholesaleOrderDueMoney != null){
			wholesaleOrderDueMoney = wholesaleOrderDueMoney.setScale(2, BigDecimal.ROUND_HALF_UP);
		}
		this.wholesaleOrderDueMoney = wholesaleOrderDueMoney;
	}

	public BigDecimal getWholesaleOrderPaidMoney() {
		return this.wholesaleOrderPaidMoney;
	}

	public void setWholesaleOrderPaidMoney(BigDecimal wholesaleOrderPaidMoney) {
		if(wholesaleOrderPaidMoney != null){
			wholesaleOrderPaidMoney = wholesaleOrderPaidMoney.setScale(2, BigDecimal.ROUND_HALF_UP);
		}
		this.wholesaleOrderPaidMoney = wholesaleOrderPaidMoney;
	}

	public Date getWholesaleOrderLastestPaymentDate() {
		return this.wholesaleOrderLastestPaymentDate;
	}

	public void setWholesaleOrderLastestPaymentDate(
			Date wholesaleOrderLastestPaymentDate) {
		this.wholesaleOrderLastestPaymentDate = wholesaleOrderLastestPaymentDate;
	}

	public String getWholesaleOrderUuid() {
		return this.wholesaleOrderUuid;
	}

	public void setWholesaleOrderUuid(String wholesaleOrderUuid) {
		this.wholesaleOrderUuid = wholesaleOrderUuid;
	}

	public Boolean getWholesaleOrderTransferFlag() {
		return this.wholesaleOrderTransferFlag;
	}

	public void setWholesaleOrderTransferFlag(Boolean wholesaleOrderTransferFlag) {
		this.wholesaleOrderTransferFlag = wholesaleOrderTransferFlag;
	}

	public List<WholesaleOrderDetail> getWholesaleOrderDetails() {
		return wholesaleOrderDetails;
	}

	public void setWholesaleOrderDetails(
			List<WholesaleOrderDetail> wholesaleOrderDetails) {
		this.wholesaleOrderDetails = wholesaleOrderDetails;
	}

	public String getWholesaleOrderPayType() {
		return wholesaleOrderPayType;
	}

	public void setWholesaleOrderPayType(String wholesaleOrderPayType) {
		this.wholesaleOrderPayType = wholesaleOrderPayType;
	}

	public BigDecimal getWholesaleOrderPayMoney() {
		return wholesaleOrderPayMoney;
	}

	public void setWholesaleOrderPayMoney(BigDecimal wholesaleOrderPayMoney) {
		this.wholesaleOrderPayMoney = wholesaleOrderPayMoney;
	}

	public Integer getAccountBankNum() {
		return accountBankNum;
	}

	public void setAccountBankNum(Integer accountBankNum) {
		this.accountBankNum = accountBankNum;
	}

	public BigDecimal getWholesaleOrderPayDiscount() {
		return wholesaleOrderPayDiscount;
	}

	public void setWholesaleOrderPayDiscount(BigDecimal wholesaleOrderPayDiscount) {
		this.wholesaleOrderPayDiscount = wholesaleOrderPayDiscount;
	}

	public String getTopCategory() {
		return topCategory;
	}

	public void setTopCategory(String topCategory) {
		this.topCategory = topCategory;
	}

	public Integer getRegionNum() {
		return regionNum;
	}

	public void setRegionNum(Integer regionNum) {
		this.regionNum = regionNum;
	}

	public String getWholesaleOrderInnerNo() {
		return wholesaleOrderInnerNo;
	}

	public void setWholesaleOrderInnerNo(String wholesaleOrderInnerNo) {
		this.wholesaleOrderInnerNo = wholesaleOrderInnerNo;
	}

	public String getSettleMentState(){
		if(wholesaleOrderPaidMoney == null){
			wholesaleOrderPaidMoney = BigDecimal.ZERO;
		}
		if(wholesaleOrderDiscountMoney == null){
			wholesaleOrderDiscountMoney = BigDecimal.ZERO;
		}
		if(wholesaleOrderPaidMoney.compareTo(BigDecimal.ZERO) == 0 && wholesaleOrderDiscountMoney.compareTo(BigDecimal.ZERO) == 0){
			return "未结算";
		} else if(wholesaleOrderDueMoney.subtract(wholesaleOrderPaidMoney).subtract(wholesaleOrderDiscountMoney).compareTo(BigDecimal.ZERO) <= 0){
			return "已结算";
		} else {
			return "部分结算";
		}
	}
	
	public BigDecimal calcMoney() {
		BigDecimal total = BigDecimal.ZERO;
		for (int i = 0; i < wholesaleOrderDetails.size(); i++) {
			WholesaleOrderDetail detail = wholesaleOrderDetails.get(i);
			total = total.add(detail.getOrderDetailMoney());
		}
		return total;
	}
	
	public static WholesaleOrder get(List<WholesaleOrder> wholesaleOrders, String wholesaleOrderFid){
		for(int i = 0;i < wholesaleOrders.size();i++){
			WholesaleOrder wholesaleOrder = wholesaleOrders.get(i);
			if(wholesaleOrder.getWholesaleOrderFid().equals(wholesaleOrderFid)){
				return wholesaleOrder;
			}
		}
		return null;
	}
	
	public void recal() {
		wholesaleOrderTotalMoney = BigDecimal.ZERO;
		for (int i = wholesaleOrderDetails.size() - 1; i >= 0; i--) {
			WholesaleOrderDetail detail = wholesaleOrderDetails.get(i);
			if(detail.getOrderDetailUseQty().compareTo(BigDecimal.ZERO) != 0){
				detail.setOrderDetailMoney(detail.getOrderDetailUseQty().multiply(detail.getOrderDetailUsePrice()).setScale(2, BigDecimal.ROUND_HALF_UP));
				detail.setOrderDetailQty(detail.getOrderDetailUseQty().multiply(detail.getOrderDetailUseRate()));
				
			}
			
			if(detail.getOrderDetailQty().compareTo(BigDecimal.ZERO) > 0){
				detail.setOrderDetailPrice(detail.getOrderDetailMoney().divide(detail.getOrderDetailQty(), 4, BigDecimal.ROUND_HALF_UP));
			}
			wholesaleOrderTotalMoney = wholesaleOrderTotalMoney.add(detail.getOrderDetailMoney());
		}
		wholesaleOrderTotalMoney = wholesaleOrderTotalMoney.setScale(2, BigDecimal.ROUND_HALF_UP);
		wholesaleOrderDueMoney = wholesaleOrderTotalMoney;
	}
	
	public void recalCostMoney() {
		wholesaleOrderCostMoney = BigDecimal.ZERO;
		for (int i = wholesaleOrderDetails.size() - 1; i >= 0; i--) {
			WholesaleOrderDetail detail = wholesaleOrderDetails.get(i);
			
			wholesaleOrderCostMoney = wholesaleOrderCostMoney.add(detail.getOrderDetailCost().multiply(detail.getOrderDetailQty()).setScale(2, BigDecimal.ROUND_HALF_UP));
		}
	}
	
	public void removeZeroDetail(){
		for(int i = wholesaleOrderDetails.size() - 1;i >= 0;i--){
			WholesaleOrderDetail detail = wholesaleOrderDetails.get(i);
			if(detail.getOrderDetailPresentQty() == null){
				detail.setOrderDetailPresentQty(BigDecimal.ZERO);
			}
			if(detail.getOrderDetailQty().compareTo(BigDecimal.ZERO) == 0 
					&& StringUtils.isEmpty(detail.getOrderDetailMemo())
					&& detail.getOrderDetailPresentQty().compareTo(BigDecimal.ZERO) == 0 ){
				wholesaleOrderDetails.remove(i);
			}
		}
	}
}
