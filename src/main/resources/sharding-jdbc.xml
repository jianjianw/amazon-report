<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:rdb="http://www.dangdang.com/schema/ddframe/rdb"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/context
                        http://www.springframework.org/schema/context/spring-context.xsd
                        http://www.dangdang.com/schema/ddframe/rdb
                        http://www.dangdang.com/schema/ddframe/rdb/rdb.xsd
                        ">


    <context:property-placeholder location="classpath:application.properties" />
    <!-- 数据库连接池 -->
    <bean id="ama" class="com.alibaba.druid.pool.DruidDataSource"
          destroy-method="close">
        <property name="url" value="${custom.datasource.asn.url}" />
        <property name="username" value="${custom.datasource.asn.username}" />
        <property name="password" value="${custom.datasource.asn.password}" />
        <property name="driverClassName" value="${custom.datasource.asn.driver-class-name}" />
    </bean>


    <rdb:strategy id="alipayLogtableShardingStrategy" sharding-columns="alipay_log_start" algorithm-class="com.nhsoft.report.sharding.TestAlipayLogTableShardingAlgorithm"/>

    <rdb:data-source  id="shardingDataSource">
        <rdb:sharding-rule data-sources="ama" default-data-source="ama">
            <rdb:table-rules>
                <rdb:table-rule logic-table="alipay_log" actual-tables="alipay_log,alipay_log_history" table-strategy="alipayLogtableShardingStrategy"/>
            </rdb:table-rules>

            <rdb:default-database-strategy sharding-columns="none" algorithm-class="com.dangdang.ddframe.rdb.sharding.api.strategy.database.NoneDatabaseShardingAlgorithm"/>
        </rdb:sharding-rule>

    </rdb:data-source>
</beans>